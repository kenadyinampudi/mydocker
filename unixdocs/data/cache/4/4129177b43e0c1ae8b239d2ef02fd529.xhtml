
<h1 class="sectionedit1" id="windchill_nfs_-_production_migration">Windchill NFS - Production Migration</h1>
<div class="level1">

<p>
On cdcpilx178
</p>
<div class="table sectionedit2"><table class="inline">
	<tr class="row0">
		<th class="col0 leftalign">Source NFS                                            </th><th class="col1">Source Mount Point</th><th class="col2 leftalign">Target NFS                                                       </th><th class="col3 leftalign">Target MountPoint           </th>
	</tr>
	<tr class="row1">
		<td class="col0 leftalign">cdcpilns013.federalmogul.com:/v11.0/prod/PTVaults5    			</td><td class="col1 leftalign">/PTVaults5        	</td><td class="col2 leftalign">cdcpilns024.pt.int.tenneco.com:/windchill_prod_vaults5/PTVaults5           </td><td class="col3 leftalign">/pnas/PTVaults5         </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign">cdcpilns013.federalmogul.com:/v11.0/prod/WindchillLogs			</td><td class="col1 leftalign">/WindchillLogs    	</td><td class="col2 leftalign">cdcpilns024.pt.int.tenneco.com:/windchill_prod/WindchillLogs               </td><td class="col3 leftalign">/pnas/WindchillLogs     </td>
	</tr>
	<tr class="row3">
		<td class="col0 leftalign">cdcpilns013.federalmogul.com:/v11.0/prod/node0        			</td><td class="col1 leftalign">/PTWindchill      	</td><td class="col2 leftalign">cdcpilns024.pt.int.tenneco.com:/windchill_prod/PTWindchill                 </td><td class="col3 leftalign">/pnas/PTWindchill       </td>
	</tr>
	<tr class="row4">
		<td class="col0 leftalign">cdcpilns013.federalmogul.com:/v11.0/PTVaults        			</td><td class="col1 leftalign">/PTVaults         	</td><td class="col2 leftalign">cdcpilns024.pt.int.tenneco.com:/windchill_prod_vaults/PTVaults             </td><td class="col3 leftalign">/pnas/PTVaults          </td>
	</tr>
	<tr class="row5">
		<td class="col0 leftalign">cdcpilns013.federalmogul.com:/v11.0/PTVaults3       			</td><td class="col1 leftalign">/PTVaults3        	</td><td class="col2 leftalign">cdcpilns024.pt.int.tenneco.com:/windchill_prod_vaults3/PTVaults3           </td><td class="col3 leftalign">/pnas/PTVaults3         </td>
	</tr>
	<tr class="row6">
		<td class="col0 leftalign">cdcpilns013.federalmogul.com:/v11.0/PTVaults4      			</td><td class="col1 leftalign">/PTVaults4        	</td><td class="col2 leftalign">cdcpilns024.pt.int.tenneco.com:/windchill_prod_vaults4/PTVaults4           </td><td class="col3 leftalign">/pnas/PTVaults4         </td>
	</tr>
	<tr class="row7">
		<td class="col0 leftalign">cdcpilns013.federalmogul.com:/v11.0/PTVaults2      			</td><td class="col1 leftalign">/PTVaults2        	</td><td class="col2 leftalign">cdcpilns024.pt.int.tenneco.com:/windchill_prod_vaults2/PTVaults2           </td><td class="col3 leftalign">/pnas/PTVaults2         </td>
	</tr>
	<tr class="row8">
		<td class="col0 leftalign">cdcpilns013.federalmogul.com:/v11.0/prod/sharedLoadXMLFiles            </td><td class="col1 leftalign">/sharedLoadXMLFiles    </td><td class="col2 leftalign">cdcpilns024.pt.int.tenneco.com:/windchill_prod/sharedLoadXMLFiles          </td><td class="col3">/pnas/sharedLoadXMLFiles</td>
	</tr>
</table></div>
<!-- EDIT2 TABLE [76-1702] -->
<p>
On cdcpillx180
</p>
<div class="table sectionedit3"><table class="inline">
	<tr class="row0">
		<th class="col0 leftalign">Source NFS                                            </th><th class="col1">Source Mount Point</th><th class="col2 leftalign">Target NFS                                                       </th><th class="col3 leftalign">Target MountPoint           </th>
	</tr>
	<tr class="row1">
		<td class="col0 leftalign">cdcpilns013.federalmogul.com:/v11.0/prod/PTVaults5    			</td><td class="col1 leftalign">/PTVaults5        	</td><td class="col2 leftalign">cdcpilns024.pt.int.tenneco.com:/windchill_prod_vaults5/PTVaults5           </td><td class="col3 leftalign">/pnas/PTVaults5         </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign">cdcpilns013.federalmogul.com:/v11.0/prod/WindchillLogs			</td><td class="col1 leftalign">/WindchillLogs    	</td><td class="col2 leftalign">cdcpilns024.pt.int.tenneco.com:/windchill_prod/WindchillLogs               </td><td class="col3 leftalign">/pnas/WindchillLogs     </td>
	</tr>
	<tr class="row3">
		<td class="col0 leftalign">cdcpilns013.federalmogul.com:/v11.0/prod/nodem        			</td><td class="col1 leftalign">/PTWindchill      	</td><td class="col2 leftalign">cdcpilns024.pt.int.tenneco.com:/windchill_prod/PTWindchill_nodem           </td><td class="col3 leftalign">/pnas/PTWindchill       </td>
	</tr>
	<tr class="row4">
		<td class="col0 leftalign">cdcpilns013.federalmogul.com:/v11.0/PTVaults        			</td><td class="col1 leftalign">/PTVaults         	</td><td class="col2 leftalign">cdcpilns024.pt.int.tenneco.com:/windchill_prod_vaults/PTVaults             </td><td class="col3 leftalign">/pnas/PTVaults          </td>
	</tr>
	<tr class="row5">
		<td class="col0 leftalign">cdcpilns013.federalmogul.com:/v11.0/PTVaults3       			</td><td class="col1 leftalign">/PTVaults3        	</td><td class="col2 leftalign">cdcpilns024.pt.int.tenneco.com:/windchill_prod_vaults3/PTVaults3           </td><td class="col3 leftalign">/pnas/PTVaults3         </td>
	</tr>
	<tr class="row6">
		<td class="col0 leftalign">cdcpilns013.federalmogul.com:/v11.0/PTVaults4      			</td><td class="col1 leftalign">/PTVaults4        	</td><td class="col2 leftalign">cdcpilns024.pt.int.tenneco.com:/windchill_prod_vaults4/PTVaults4           </td><td class="col3 leftalign">/pnas/PTVaults4         </td>
	</tr>
	<tr class="row7">
		<td class="col0 leftalign">cdcpilns013.federalmogul.com:/v11.0/PTVaults2      			</td><td class="col1 leftalign">/PTVaults2        	</td><td class="col2 leftalign">cdcpilns024.pt.int.tenneco.com:/windchill_prod_vaults2/PTVaults2           </td><td class="col3 leftalign">/pnas/PTVaults2         </td>
	</tr>
	<tr class="row8">
		<td class="col0 leftalign">cdcpilns013.federalmogul.com:/v11.0/prod/sharedLoadXMLFiles            </td><td class="col1 leftalign">/sharedLoadXMLFiles    </td><td class="col2 leftalign">cdcpilns024.pt.int.tenneco.com:/windchill_prod/sharedLoadXMLFiles          </td><td class="col3">/pnas/sharedLoadXMLFiles</td>
	</tr>
</table></div>
<!-- EDIT3 TABLE [1719-3345] -->
<p>
On cdcpillx181
</p>
<div class="table sectionedit4"><table class="inline">
	<tr class="row0">
		<th class="col0 leftalign">Source NFS                                            </th><th class="col1">Source Mount Point</th><th class="col2 leftalign">Target NFS                                                       </th><th class="col3 leftalign">Target MountPoint           </th>
	</tr>
	<tr class="row1">
		<td class="col0 leftalign">cdcpilns013.federalmogul.com:/v11.0/prod/PTVaults5    			</td><td class="col1 leftalign">/PTVaults5        	</td><td class="col2 leftalign">cdcpilns024.pt.int.tenneco.com:/windchill_prod_vaults5/PTVaults5           </td><td class="col3 leftalign">/pnas/PTVaults5         </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign">cdcpilns013.federalmogul.com:/v11.0/prod/WindchillLogs			</td><td class="col1 leftalign">/WindchillLogs    	</td><td class="col2 leftalign">cdcpilns024.pt.int.tenneco.com:/windchill_prod/WindchillLogs               </td><td class="col3 leftalign">/pnas/WindchillLogs     </td>
	</tr>
	<tr class="row3">
		<td class="col0 leftalign">cdcpilns013.federalmogul.com:/v11.0/prod/node1        			</td><td class="col1 leftalign">/PTWindchill      	</td><td class="col2 leftalign">cdcpilns024.pt.int.tenneco.com:/windchill_prod/PTWindchill_node1           </td><td class="col3 leftalign">/pnas/PTWindchill       </td>
	</tr>
	<tr class="row4">
		<td class="col0 leftalign">cdcpilns013.federalmogul.com:/v11.0/PTVaults        			</td><td class="col1 leftalign">/PTVaults         	</td><td class="col2 leftalign">cdcpilns024.pt.int.tenneco.com:/windchill_prod_vaults/PTVaults             </td><td class="col3 leftalign">/pnas/PTVaults          </td>
	</tr>
	<tr class="row5">
		<td class="col0 leftalign">cdcpilns013.federalmogul.com:/v11.0/PTVaults3       			</td><td class="col1 leftalign">/PTVaults3        	</td><td class="col2 leftalign">cdcpilns024.pt.int.tenneco.com:/windchill_prod_vaults3/PTVaults3           </td><td class="col3 leftalign">/pnas/PTVaults3         </td>
	</tr>
	<tr class="row6">
		<td class="col0 leftalign">cdcpilns013.federalmogul.com:/v11.0/PTVaults4      			</td><td class="col1 leftalign">/PTVaults4        	</td><td class="col2 leftalign">cdcpilns024.pt.int.tenneco.com:/windchill_prod_vaults4/PTVaults4           </td><td class="col3 leftalign">/pnas/PTVaults4         </td>
	</tr>
	<tr class="row7">
		<td class="col0 leftalign">cdcpilns013.federalmogul.com:/v11.0/PTVaults2      			</td><td class="col1 leftalign">/PTVaults2        	</td><td class="col2 leftalign">cdcpilns024.pt.int.tenneco.com:/windchill_prod_vaults2/PTVaults2           </td><td class="col3 leftalign">/pnas/PTVaults2         </td>
	</tr>
	<tr class="row8">
		<td class="col0 leftalign">cdcpilns013.federalmogul.com:/v11.0/prod/sharedLoadXMLFiles            </td><td class="col1 leftalign">/sharedLoadXMLFiles    </td><td class="col2 leftalign">cdcpilns024.pt.int.tenneco.com:/windchill_prod/sharedLoadXMLFiles          </td><td class="col3">/pnas/sharedLoadXMLFiles</td>
	</tr>
</table></div>
<!-- EDIT4 TABLE [3362-4988] -->
<p>
On cdcpillx182
</p>
<div class="table sectionedit5"><table class="inline">
	<tr class="row0">
		<th class="col0 leftalign">Source NFS                                            </th><th class="col1">Source Mount Point</th><th class="col2 leftalign">Target NFS                                                       </th><th class="col3 leftalign">Target MountPoint           </th>
	</tr>
	<tr class="row1">
		<td class="col0 leftalign">cdcpilns013.federalmogul.com:/v11.0/prod/PTVaults5    			</td><td class="col1 leftalign">/PTVaults5        	</td><td class="col2 leftalign">cdcpilns024.pt.int.tenneco.com:/windchill_prod_vaults5/PTVaults5           </td><td class="col3 leftalign">/pnas/PTVaults5         </td>
	</tr>
	<tr class="row2">
		<td class="col0 leftalign">cdcpilns013.federalmogul.com:/v11.0/prod/WindchillLogs			</td><td class="col1 leftalign">/WindchillLogs    	</td><td class="col2 leftalign">cdcpilns024.pt.int.tenneco.com:/windchill_prod/WindchillLogs               </td><td class="col3 leftalign">/pnas/WindchillLogs     </td>
	</tr>
	<tr class="row3">
		<td class="col0 leftalign">cdcpilns013.federalmogul.com:/v11.0/prod/node2        			</td><td class="col1 leftalign">/PTWindchill      	</td><td class="col2 leftalign">cdcpilns024.pt.int.tenneco.com:/windchill_prod/PTWindchill_node2           </td><td class="col3 leftalign">/pnas/PTWindchill       </td>
	</tr>
	<tr class="row4">
		<td class="col0 leftalign">cdcpilns013.federalmogul.com:/v11.0/PTVaults        			</td><td class="col1 leftalign">/PTVaults         	</td><td class="col2 leftalign">cdcpilns024.pt.int.tenneco.com:/windchill_prod_vaults/PTVaults             </td><td class="col3 leftalign">/pnas/PTVaults          </td>
	</tr>
	<tr class="row5">
		<td class="col0 leftalign">cdcpilns013.federalmogul.com:/v11.0/PTVaults3       			</td><td class="col1 leftalign">/PTVaults3        	</td><td class="col2 leftalign">cdcpilns024.pt.int.tenneco.com:/windchill_prod_vaults3/PTVaults3           </td><td class="col3 leftalign">/pnas/PTVaults3         </td>
	</tr>
	<tr class="row6">
		<td class="col0 leftalign">cdcpilns013.federalmogul.com:/v11.0/PTVaults4      			</td><td class="col1 leftalign">/PTVaults4        	</td><td class="col2 leftalign">cdcpilns024.pt.int.tenneco.com:/windchill_prod_vaults4/PTVaults4           </td><td class="col3 leftalign">/pnas/PTVaults4         </td>
	</tr>
	<tr class="row7">
		<td class="col0 leftalign">cdcpilns013.federalmogul.com:/v11.0/PTVaults2      			</td><td class="col1 leftalign">/PTVaults2        	</td><td class="col2 leftalign">cdcpilns024.pt.int.tenneco.com:/windchill_prod_vaults2/PTVaults2           </td><td class="col3 leftalign">/pnas/PTVaults2         </td>
	</tr>
	<tr class="row8">
		<td class="col0 leftalign">cdcpilns013.federalmogul.com:/v11.0/prod/sharedLoadXMLFiles            </td><td class="col1 leftalign">/sharedLoadXMLFiles    </td><td class="col2 leftalign">cdcpilns024.pt.int.tenneco.com:/windchill_prod/sharedLoadXMLFiles          </td><td class="col3">/pnas/sharedLoadXMLFiles</td>
	</tr>
</table></div>
<!-- EDIT5 TABLE [5005-6631] -->
</div>
<!-- EDIT1 SECTION "Windchill NFS - Production Migration" [1-6632] -->
<h2 class="sectionedit6" id="pre-work">Pre-work</h2>
<div class="level2">
<ol>
<li class="level1"><div class="li"> Initial copy operations<pre class="code">On cdcpillx181 

rsync -avh --exclude &#039;.snapshot&#039; /PTVaults5/ /pnas/PTVaults5/
rsync -avh --exclude &#039;.snapshot&#039; /WindchillLogs/ /pnas/WindchillLogs/
rsync -avh --exclude &#039;.snapshot&#039; /PTWindchill/ /pnas/PTWindchill/
rsync -avh --exclude &#039;.snapshot&#039; /PTVaults/ /pnas/PTVaults/
rsync -avh --exclude &#039;.snapshot&#039; /PTVaults3/ /pnas/PTVaults3/
rsync -avh --exclude &#039;.snapshot&#039; /PTVaults4/ /pnas/PTVaults4/
rsync -avh --exclude &#039;.snapshot&#039; /PTVaults2/ /pnas/PTVaults2/
rsync -avh --exclude &#039;.snapshot&#039; /sharedLoadXMLFiles/ /pnas/sharedLoadXMLFiles/

On cdcpillx178

rsync -avh --exclude &#039;.snapshot&#039; /PTWindchill/ /pnas/PTWindchill/

On cdcpillx180

rsync -avh --exclude &#039;.snapshot&#039; /PTWindchill/ /pnas/PTWindchill/

On cdcpillx182

rsync -avh --exclude &#039;.snapshot&#039; /PTWindchill/ /pnas/PTWindchill/</pre>
</div>
</li>
</ol>

<p>
## –exclude is to exclude the readonly .snapshot directory automatically created on the NAS share by storage system
</p>

</div>
<!-- EDIT6 SECTION "Pre-work" [6633-7602] -->
<h2 class="sectionedit7" id="cutover_steps">Cutover steps</h2>
<div class="level2">
<ol>
<li class="level1"><div class="li"> Shutdown Windchill applications on cdcpillx178,cdcpillx180,cdcpillx181,cdcpillx182</div>
</li>
<li class="level1"><div class="li"> Remount the existing Windchill NFS to a new mountpoint.</div>
<ol>
<li class="level2"><div class="li"> Unmount existing filesystems on cdcpillx178,cdcpillx180,cdcpillx181,cdcpillx182<pre class="code">umount /PTVaults5
umount /WindchillLogs
umount /PTWindchill
umount /PTVaults
umount /PTVaults3
umount /PTVaults4
umount /PTVaults2
umount /sharedLoadXMLFiles</pre>
</div>
</li>
<li class="level2"><div class="li"> Mount the existing filesystems to a new mountpoint<pre class="code">mkdir -p /hnas/PTVaults5
mkdir -p /hnas/WindchillLogs
mkdir -p /hnas/PTWindchill
mkdir -p /hnas/PTVaults
mkdir -p /hnas/PTVaults3
mkdir -p /hnas/PTVaults4
mkdir -p /hnas/PTVaults2
mkdir -p /hnas/sharedLoadXMLFiles

On cdcpillx181
mount cdcpilns011.federalmogul.com:/v11.0/prod/WindchillLogs        /hnas/WindchillLogs
mount cdcpilns011.federalmogul.com:/PTVaults4                       /hnas/PTVaults4
mount cdcpilns011.federalmogul.com:/v11.0/prod/PTVaults5            /hnas/PTVaults5
mount cdcpilns011.federalmogul.com:/PTVaults3                       /hnas/PTVaults3
mount cdcpilns011.federalmogul.com:/v11.0/prod/sharedLoadXMLFiles   /hnas/sharedLoadXMLFiles
mount cdcpilns011.federalmogul.com:/v11.0/prod/node1                /hnas/PTWindchill
mount cdcpilns011.federalmogul.com:/PTVaults                        /hnas/PTVaults
mount cdcpilns011.federalmogul.com:/PTVaults2                       /hnas/PTVaults2

On cdcpillx178

mount cdcpilns013.federalmogul.com:/v11.0/prod/node0         /hnas/PTWindchill

On cdcpillx182

mount cdcpilns013.federalmogul.com:/v11.0/prod/node2         /hnas/PTWindchill

On cdcpillx180

mount cdcpilns013.federalmogul.com:/v11.0/prod/nodem         /hnas/PTWindchill</pre>
</div>
</li>
</ol>
</li>
</ol>
<ol>
<li class="level1"><div class="li"> Final rsync operation<pre class="code">
On cdcpillx181

rsync --delete -avch --exclude &#039;.snapshot&#039; /hnas/WindchillLogs/ /pnas/WindchillLogs/ | tee -a WindchillLogs.rsync.log	
rsync --delete -avch --exclude &#039;.snapshot&#039; /hnas/PTWindchill/ /pnas/PTWindchill/ | tee -a PTWindchill_181.rsync.log	
rsync --delete -avch --exclude &#039;.snapshot&#039; /hnas/sharedLoadXMLFiles/ /pnas/sharedLoadXMLFiles/ | tee -a sharedLoadXMLFiles.rsync.log
rsync --delete -avh --exclude &#039;.snapshot&#039; /hnas/PTVaults/ /pnas/PTVaults/ | tee -a PTVaults.rsync.log
rsync --delete -avh --exclude &#039;.snapshot&#039; /hnas/PTVaults3/ /pnas/PTVaults3/ | tee -a PTVaults3.rsync.log	
rsync --delete -avh --exclude &#039;.snapshot&#039; /hnas/PTVaults2/ /pnas/PTVaults2/ | tee -a PTVaults2.rsync.log
rsync --delete -avch --exclude &#039;.snapshot&#039; /hnas/PTVaults5/ /pnas/PTVaults5/ | tee -a PTVaults5.rsync.log	
rsync --delete -avh --exclude &#039;.snapshot&#039; /hnas/PTVaults4/ /pnas/PTVaults4/ | tee -a PTVaults4.rsync.log

On cdcpillx178
rsync --delete -avhc /hnas/PTWindchill/  	/pnas/PTWindchill/       | tee -a PTWindchill_178.rsync.log

On cdcpillx182
rsync --delete -avhc /hnas/PTWindchill/  	/pnas/PTWindchill/       | tee -a PTWindchill_182.rsync.log

On cdcpillx180
rsync --delete -avhc /hnas/PTWindchill/  	/pnas/PTWindchill/       | tee -a PTWindchill_180.rsync.log</pre>
</div>
</li>
</ol>
<ol>
<li class="level1"><div class="li"> Remount ”/pnas” filesystems as original and handover to Apps team</div>
<ol>
<li class="level2"><div class="li"> Unmount the Pure NAS mountpoints<pre class="code">umount /pnas/PTVaults5
umount /pnas/PTWindchill
umount /pnas/WindchillLogs
umount /pnas/PTVaults
umount /pnas/PTVaults3
umount /pnas/PTVaults4
umount /pnas/PTVaults2
umount /pnas/sharedLoadXMLFiles</pre>
</div>
</li>
<li class="level2"><div class="li"> Manipulate the fstab so that the original mount points are now mounted from Pure NAS.</div>
</li>
<li class="level2"><div class="li"> Mount the filesytems<pre class="code">mount /PTVaults5
mount /PTWindchill
mount /WindchillLogs
mount /PTVaults
mount /PTVaults3
mount /PTVaults4
mount /PTVaults2
mount /sharedLoadXMLFiles</pre>
</div>
</li>
</ol>
</li>
<li class="level1"><div class="li"> Handover to Apps team</div>
</li>
</ol>

</div>
<!-- EDIT7 SECTION "Cutover steps" [7603-] -->